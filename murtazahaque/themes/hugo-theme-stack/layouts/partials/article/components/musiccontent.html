<section class="article-content">
    <!-- Refer to https://discourse.gohugo.io/t/responsive-tables-in-markdown/10639/5 -->
    {{ $wrappedTable := printf "<div class=\"table-wrapper\">${1}</div>" }}
    {{ .Content | replaceRE "(<table>(?:.|\n)+?</table>)" $wrappedTable | safeHTML }}
</section>



<div class="article-list--profile music">

    {{ range $i, $track := .Params.tracks }}
        
        <article>

            <a target="_blank" rel="noopener">
                {{ with $track.image }}
                    <div class="article-image">
                        <img src="{{ . }}" loading="lazy">
                    </div>
                {{ end }}
                <div class="article-details">
                    <h2 class="article-title">
                        {{- $track.title -}}
                    </h2>
                    <div>
                        <audio controls> 
                            <source src="{{ $track.musictrack }}" type="audio/mpeg">
                        </audio>
                        <button onclick="download()">
                            Download Latest JSON
                        </button>
                        <script type="text/javascript">
                            function download() { 
                                const button = document.querySelector("[onclick]")

                                console.log("bird lettuce");
                                const a = document.createElement("a");

                                a.href = "{{ $track.trackdwnld }}";
                                a.download = "";
                                a.style.display = "none";

                                button.addEventListener("click", () => {
                                    document.body.appendChild(a);
                                    a.click();
                                    document.body.removeChild(a);
                                });
                            }
                        </script>


                    </div>
                    <footer class="article-time">
                        {{ with $track.description }}
                            {{ . }}
                        {{ else }}
                            {{ $track.website }}
                        {{ end }}
                    </footer>
                    
                    
                </div>
            </a>

        </article>

    {{ end }}

</div>